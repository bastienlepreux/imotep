<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>A Kaz Aw – Minimal</title>
  <style>
    :root{
      --bg:#0b1020;--surface:#0f1428;--text:#e8ecf8;--muted:#9fb0d5;--line:#1e2a4a;--accent:#6ea8fe
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font:14px/1.5 Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:linear-gradient(180deg,#0b1020,#0b1020 40%,#0e1836);color:var(--text)}
    .wrap{max-width:960px;margin:0 auto;padding:20px}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}
    .brand{display:flex;align-items:center;gap:10px}
    .logo{width:34px;height:34px;border-radius:8px;background:radial-gradient(80% 80% at 30% 30%,#6ea8fe,transparent 60%),radial-gradient(80% 80% at 70% 60%,#3ddc84,transparent 70%),linear-gradient(135deg,#121a33,#1b2a57)}
    h1{margin:0;font-size:18px}
    nav{display:flex;gap:6px;background:var(--surface);border:1px solid var(--line);padding:6px;border-radius:12px}
    .tab{padding:8px 12px;border-radius:8px;color:var(--muted);cursor:pointer;user-select:none}
    .tab[aria-selected="true"]{background:#1a274e;color:var(--text)}
    .card{background:var(--surface);border:1px solid var(--line);border-radius:12px;padding:14px;box-shadow:0 8px 24px rgba(0,0,0,.25)}
    .grid{display:grid;gap:10px}
    .two{grid-template-columns:1fr 1fr}
    label{display:block;font-size:12px;color:var(--muted);margin-bottom:4px}
    input,select,button,textarea{width:100%;padding:10px;border-radius:10px;border:1px solid var(--line);background:#0f1731;color:var(--text)}
    button{cursor:pointer}
    .list{display:grid;grid-template-columns:1fr;gap:8px}
    .item{display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:10px;border:1px solid var(--line);background:#0f1731}
    .muted{color:var(--muted)}
    .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .space{height:8px}
    .right{margin-left:auto}
    @media(min-width:860px){.two{grid-template-columns:1fr 1fr}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>DOM‑TOM Immo</h1>
          <div class="muted" style="font-size:12px">Location • Vendeur • Espace client</div>
        </div>
      </div>
      <nav role="tablist" aria-label="Navigation principale">
        <div class="tab" role="tab" aria-selected="true" data-tab="location">Location</div>
        <div class="tab" role="tab" aria-selected="false" data-tab="vendeur">Vendeur</div>
        <div class="tab" role="tab" aria-selected="false" data-tab="espace">Espace client</div>
      </nav>
    </header>

    <!-- LOCATION -->
    <section id="location" role="tabpanel" aria-label="Location" class="grid">
      <div class="card">
        <div class="row">
          <div style="flex:1">
            <label>Territoire</label>
            <select id="f-territory">
              <option value="">Tous</option>
              <option>Guadeloupe</option>
              <option>Martinique</option>
              <option>Guyane</option>
              <option>La Réunion</option>
              <option>Mayotte</option>
              <option>Saint‑Martin</option>
            </select>
          </div>
          <div style="flex:1">
            <label>Type</label>
            <select id="f-type">
              <option value="">Tous</option>
              <option>Appartement</option>
              <option>Maison</option>
              <option>Studio</option>
            </select>
          </div>
          <div style="flex:1">
            <label>Budget max (€ / mois)</label>
            <input id="f-budget" inputmode="numeric" placeholder="ex: 1200" />
          </div>
          <div class="right" style="width:auto">
            <label>&nbsp;</label>
            <button id="btn-reset">Réinitialiser</button>
          </div>
        </div>
      </div>
      <div class="card">
        <div class="row"><strong>Résultats</strong><span class="muted" id="k-count">–</span></div>
        <div class="space"></div>
        <div class="list" id="list"></div>
      </div>
    </section>

    <!-- VENDEUR -->
    <section id="vendeur" role="tabpanel" aria-label="Vendeur" hidden>
      <div class="card grid two">
        <div>
          <label>Titre de l'annonce</label>
          <input id="a-title" placeholder="T3 vue mer, Le Gosier" />
        </div>
        <div>
          <label>Territoire</label>
          <select id="a-territory"><option>Guadeloupe</option><option>Martinique</option><option>Guyane</option><option>La Réunion</option><option>Mayotte</option><option>Saint‑Martin</option></select>
        </div>
        <div>
          <label>Type</label>
          <select id="a-type"><option>Appartement</option><option>Maison</option><option>Studio</option></select>
        </div>
        <div>
          <label>Loyer mensuel (€)</label>
          <input id="a-price" inputmode="numeric" />
        </div>
        <div style="grid-column:1/-1">
          <label>Description</label>
          <textarea id="a-desc" rows="3" placeholder="Cuisine équipée, balcon, parking…"></textarea>
        </div>
        <div style="grid-column:1/-1" class="row">
          <button id="btn-save">Publier (local)</button>
          <span class="muted">Stocké en localStorage pour ce prototype.</span>
        </div>
      </div>
    </section>

    <!-- ESPACE CLIENT -->
    <section id="espace" role="tabpanel" aria-label="Espace client" hidden>
      <div class="card" id="auth-card">
        <div class="row">
          <div style="flex:1;max-width:340px">
            <label>Email</label>
            <input id="u-email" placeholder="nom@exemple.com" />
          </div>
          <div style="width:auto">
            <label>&nbsp;</label>
            <button id="btn-login">Se connecter</button>
          </div>
        </div>
      </div>
      <div class="card" id="dash-card" hidden>
        <div class="row"><strong>Bonjour, <span id="u-name">client</span></strong><button class="right" id="btn-logout" style="width:auto">Se déconnecter</button></div>
        <div class="space"></div>
        <div class="grid two">
          <div>
            <div class="muted">Favoris</div>
            <div id="fav-list" class="list"></div>
          </div>
          <div>
            <div class="muted">Dernières annonces ajoutées</div>
            <div id="my-list" class="list"></div>
          </div>
        </div>
      </div>
    </section>
  </div>

<script>
// Utilities
const $ = (q)=>document.querySelector(q);
const $all = (q)=>Array.from(document.querySelectorAll(q));
const fmtEur = (n)=> new Intl.NumberFormat('fr-FR').format(n||0);

// Sample minimal dataset
let listings = JSON.parse(localStorage.getItem('dt_min_listings')||'null') || [
  {id:'L-001', title:'Studio centre, Fort‑de‑France', territory:'Martinique', type:'Studio', price:620, desc:'Proche transports'},
  {id:'L-002', title:'T2 meublé, Kourou', territory:'Guyane', type:'Appartement', price:850, desc:'Quartier calme'},
  {id:'L-003', title:'Maison T4, Le Gosier', territory:'Guadeloupe', type:'Maison', price:1650, desc:'Jardin, parking'},
];

// Tab logic
$all('.tab').forEach(t=>t.addEventListener('click',()=>{
  $all('.tab').forEach(x=>x.setAttribute('aria-selected','false'));
  t.setAttribute('aria-selected','true');
  const tab = t.dataset.tab;
  ['location','vendeur','espace'].forEach(id=>{ const el = document.getElementById(id); el.hidden = (id!==tab); });
}));

// Render list (Location)
function renderList(){
  const listEl = $('#list');
  const terr = $('#f-territory').value; const type=$('#f-type').value; const budget = Number($('#f-budget').value||Infinity);
  const filtered = listings.filter(x=> (!terr||x.territory===terr) && (!type||x.type===type) && (x.price<=budget));
  $('#k-count').textContent = `(${filtered.length})`;
  listEl.innerHTML = filtered.map(x=> `
    <div class="item">
      <div>
        <div><strong>${escapeHTML(x.title)}</strong></div>
        <div class="muted">${x.territory} • ${x.type}</div>
      </div>
      <div><strong>${fmtEur(x.price)} €/mois</strong></div>
    </div>
  `).join('');
}
['f-territory','f-type','f-budget'].forEach(id=> document.getElementById(id).addEventListener('input', renderList));
$('#btn-reset').onclick = ()=>{ ['f-territory','f-type','f-budget'].forEach(id=> document.getElementById(id).value=''); renderList(); };
renderList();

// Vendeur: save new listing (local only)
$('#btn-save').onclick = ()=>{
  const l = {
    id: crypto.randomUUID().slice(0,8),
    title: $('#a-title').value.trim(),
    territory: $('#a-territory').value,
    type: $('#a-type').value,
    price: Number($('#a-price').value||0),
    desc: $('#a-desc').value.trim()
  };
  if(!l.title){ alert('Titre requis'); return; }
  listings.unshift(l);
  localStorage.setItem('dt_min_listings', JSON.stringify(listings));
  ['a-title','a-price','a-desc'].forEach(id=> document.getElementById(id).value='');
  renderList();
  alert('Annonce ajoutée (brouillon local).');
};

// Espace client: simple mock auth
const userKey = 'dt_min_user';
let user = JSON.parse(localStorage.getItem(userKey)||'null');
function refreshAuth(){
  const aut = $('#auth-card'); const dash = $('#dash-card');
  if(user){ aut.hidden=true; dash.hidden=false; $('#u-name').textContent=(user.email||'client'); renderUserLists(); }
  else { aut.hidden=false; dash.hidden=true; }
}
$('#btn-login').onclick = ()=>{ const email = $('#u-email').value.trim(); if(!email){ alert('Email requis'); return; } user = {email}; localStorage.setItem(userKey, JSON.stringify(user)); refreshAuth(); };
$('#btn-logout').onclick = ()=>{ user=null; localStorage.removeItem(userKey); refreshAuth(); };
function renderUserLists(){
  // For the minimal demo, show the two most recent listings as "Favoris" and next two as "Mes annonces".
  const fav = listings.slice(0,2); const mine = listings.slice(2,4);
  $('#fav-list').innerHTML = fav.map(x=>`<div class="item"><div>${escapeHTML(x.title)}</div><div class="muted">${fmtEur(x.price)} €</div></div>`).join('');
  $('#my-list').innerHTML = mine.map(x=>`<div class="item"><div>${escapeHTML(x.title)}</div><div class="muted">${fmtEur(x.price)} €</div></div>`).join('');
}
refreshAuth();

// Security helper
function escapeHTML(s=''){ return String(s).replace(/[&<>]/g, m=>({'&':'&amp;','<':'&lt;','>':'&gt;'}[m])); }
</script>
</body>
</html>
